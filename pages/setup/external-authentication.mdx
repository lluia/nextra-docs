import { Callout } from "nextra/components";

# External Authentication

Auth.js is built in a way that is easy and flexible to integrate with any authentication back-end.

<Callout>
  Auth.js is just a bridge, giving you the tools to manage the user session
  client-side in a safe way without having to be an expert in authentication.
</Callout>

## Setting Auth.js & Next.js

For this tutorial, we're gonna use the default [Auth.js & Next.js example app](https://github.com/nextauthjs/next-auth-example). If you already have an existing Next.js app, it should work too. If you haven't, clone the repository:

```bash
git clone https://github.com/nextauthjs/next-auth-example.git && cd next-auth-example
```

If you're using the example app, Auth.js is already installed, otherwise follow the [installation instructions](/installation).

## Configuring Auth.js

We'll use the `CredentialsProvider`, which is designed to forward any inserted credentials (.i.e username/password) in the sign in form to your authentication service. This provider is very flexible, and can be easily setup to work with different authentication methods like [WebAuthn](https://webauthn.io/).

<Callout type="warning">
  The functionality provided by the `CredentialsProvider` is intentionally
  limited in favour of flexibility and to discourage the use of passwords due to
  the inherent security risks associated with them (and the additional
  complexity associated with supporting usernames and passwords).
</Callout>

Integrating the Credentials Provider is as simple as initializing it in the Auth.js configuration file:

```ts filename="pages/api/auth/[...nextauth].ts"
import NextAuth from "next-auth";
import CredentialsProvider from "next-auth/providers/credentials";

export default NextAuth({
  providers: [
    CredentialsProvider({
      // `credentials` will usually contain the inserted username/password
      // in the sign in form
      async authorize(credentials) {
        const authResponse = await fetch("/users/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(credentials),
        });

        if (!authResponse.ok) {
          return null;
        }

        const user = await authResponse.json();

        return user;
      },
    }),
  ],
});
```

Note that we only had to define a single `authorize` method that is in charge of receiving the credentials inserted by the user and call whatever authentication service we want to use. Auth.js will then be in charge of managing the user session for us.

- [Check the Credentials Provider options](/reference/core/providers/credentials) for further customization

<Callout type="info">
  If you're using TypeScript, you can [augment the `User`
  interface](/getting-started/typescript#module-augmentation) to match the
  response of your `authorize` callback, so whenever you read the user in other
  callbacks (like the `jwt`) the type will match correctly.
</Callout>
